
import torch
import numpy as np


bos_symbol=3
eos_symbol=5
pad_symbol=6
add_bos=True
add_eos=True

texts = [[[[150, 34], [169, 21], [169, 21], [108, 161], [174, 161], [108, 161], [200, 161], [200, 1], [155, 137], [91, 130], [91, 23], [91, 244], [79, 174], [79, 174], [73, 161], [64, 21], [169, 144], [109, 183], [109, 183], [91, 214], [81, 161], [81, 161], [108, 161], [143, 161], [215, 161], [21, 116], [10, 126], [64, 126], [21, 46], [130, 21], [130, 153], [73, 193], [143, 193], [108, 46], [206, 248], [206, 158], [79, 38], [108, 38], [64, 42], [64, 144], [10, 23], [206, 23], [206, 130], [73, 180], [21, 236], [124, 1], [125, 161], [125, 126], [241, 116], [64, 152], [218, 152], [81, 180], [64, 161], [143, 161], [174, 161], [174, 161], [64, 161], [81, 126], [155, 134], [64, 158], [218, 46], [200, 180], [190, 131], [79, 131], [79, 131], [79, 131], [171, 131], [81, 180], [81, 126], [64, 231], [108, 185], [10, 158], [64, 42], [125, 34], [125, 183], [125, 183], [125, 34], [79, 34], [189, 183], [91, 244], [200, 161], [200, 161], [81, 174], [81, 202], [200, 158], [155, 158], [91, 158], [91, 154], [91, 116], [81, 161], [108, 161], [64, 161], [125, 161], [64, 202], [81, 96], [155, 158], [10, 221], [81, 126], [81, 126], [241, 173], [206, 130], [91, 226], [91, 124], [143, 161], [143, 161], [200, 161], [81, 161], [81, 90], [81, 131], [200, 131], [200, 46], [200, 158], [228, 134], [91, 236], [64, 158], [174, 158], [218, 158], [64, 131], [125, 90], [125, 90], [174, 161], [73, 176], [93, 23], [81, 65], [81, 23], [11, 9], [106, 158], [106, 46], [79, 131], [200, 131], [81, 131], [81, 90], [81, 202], [81, 202], [81, 126], [200, 126], [190, 231], [200, 244], [206, 177], [200, 96], [189, 96], [189, 116], [200, 126], [81, 161], [174, 193], [236, 21], [215, 21], [215, 21], [215, 134], [73, 174], [73, 174], [73, 161], [174, 161], [108, 126], [108, 180], [21, 3], [91, 70], [109, 177], [109, 177], [109, 89], [21, 134], [21, 3], [21, 185], [108, 38], [190, 161], [200, 161], [81, 161], [7, 126], [7, 89], [207, 144], [81, 124], [108, 161], [81, 161], [200, 38], [177, 38], [81, 126], [108, 126], [91, 126], [165, 180], [165, 134], [19, 21], [86, 215], [130, 221], [108, 161], [174, 161], [73, 161], [108, 161], [108, 161], [64, 161], [64, 161], [64, 174], [155, 90], [228, 244], [169, 183], [109, 183], [109, 23], [206, 177], [206, 177], [206, 183], [91, 23], [163, 34], [125, 34], [125, 34], [125, 183], [125, 183], [125, 23], [64, 34], [228, 21], [228, 116], [200, 161], [200, 161], [200, 161], [79, 161], [79, 161], [190, 130], [210, 183], [200, 161], [108, 161], [79, 161], [79, 193], [79, 46], [79, 248], [162, 158], [200, 174], [81, 202], [64, 42], [109, 144], [206, 144], [206, 65], [206, 89], [109, 126], [64, 126], [64, 161], [108, 161], [73, 161], [215, 161], [190, 126], [200, 24], [228, 158], [218, 33], [50, 126], [64, 126], [64, 180], [64, 21], [228, 144], [81, 131], [64, 131], [64, 131], [64, 131], [64, 131], [64, 90], [91, 90], [91, 202], [91, 214], [91, 183], [91, 23], [109, 183], [210, 130], [207, 130], [163, 89], [163, 34], [163, 34], [163, 34]]], [[[89, 34], [163, 34], [189, 161], [64, 161], [81, 161], [190, 45], [155, 46], [155, 152], [160, 116], [106, 131], [106, 131], [91, 116], [23, 1], [64, 161], [101, 126], [108, 126], [50, 151], [228, 70], [79, 161], [215, 174], [50, 248], [50, 144], [106, 116], [108, 126], [108, 180], [163, 3], [163, 107], [79, 181], [79, 160], [79, 46], [220, 158], [106, 107], [106, 160], [73, 161], [174, 161], [125, 161], [125, 161], [125, 131], [155, 180], [177, 226], [206, 144], [206, 177], [10, 144], [241, 23], [206, 124], [64, 116], [64, 21], [64, 144], [64, 144], [206, 144], [206, 177], [206, 177], [83, 183], [207, 173], [81, 161], [81, 161], [81, 161], [79, 161], [79, 161], [79, 161], [79, 161], [108, 161], [108, 161], [215, 161], [236, 252], [23, 77], [177, 181], [73, 131], [73, 180], [125, 161], [64, 161], [64, 161], [81, 151], [23, 114], [23, 9], [207, 114], [210, 107], [210, 38], [81, 126], [64, 90], [64, 90], [64, 90], [64, 90], [64, 202], [81, 126], [43, 152], [43, 248], [130, 144], [130, 23], [130, 183], [200, 202], [190, 90], [79, 33], [79, 33], [190, 131], [200, 90], [81, 90], [81, 202], [64, 90], [64, 131], [106, 248], [106, 12], [81, 131], [81, 180], [81, 152], [155, 21], [155, 160], [108, 126], [108, 126], [108, 231], [21, 45], [23, 144], [210, 183], [109, 124], [200, 116], [108, 46], [155, 158], [64, 21], [64, 144], [206, 144], [206, 144], [206, 144], [206, 177], [206, 244], [79, 161], [79, 161], [79, 161], [79, 231], [236, 160], [7, 107], [108, 161], [81, 126], [206, 134], [206, 89], [109, 21], [228, 248], [228, 1], [190, 116], [190, 183], [206, 177], [53, 144], [10, 248], [109, 126], [81, 180], [81, 131], [64, 131], [106, 3], [21, 144], [214, 70], [125, 126], [125, 161], [125, 161], [125, 126], [125, 180], [21, 96], [228, 158], [228, 152], [155, 116], [155, 152], [10, 130], [206, 130], [91, 130], [91, 244], [91, 193], [190, 126], [190, 126], [200, 126], [200, 126], [81, 202], [81, 90], [91, 180], [91, 185], [91, 107], [228, 107], [177, 77], [163, 34], [189, 34], [155, 160], [155, 126], [108, 158], [64, 144], [206, 144], [206, 177], [206, 144], [23, 144], [241, 23], [206, 183], [206, 130], [91, 116], [73, 185], [73, 46], [73, 158], [155, 46], [79, 131], [106, 131], [64, 202], [241, 173], [109, 177], [109, 89], [109, 23], [130, 23], [130, 183], [200, 180], [190, 131], [106, 180], [64, 46], [64, 21], [212, 248], [212, 160], [79, 174], [79, 174], [79, 174], [79, 174], [79, 174], [79, 161], [79, 161], [171, 126], [171, 116], [79, 116], [79, 116], [79, 46], [163, 34], [163, 34], [163, 34], [163, 34], [163, 34], [163, 34], [163, 34], [125, 34], [163, 34], [106, 131], [64, 131], [81, 42], [81, 144], [10, 23], [206, 183], [206, 214], [73, 131], [73, 131], [73, 131], [190, 131], [200, 131], [200, 180], [200, 185], [200, 151], [155, 107], [155, 21], [83, 144], [83, 23], [11, 137], [11, 160], [79, 160], [79, 181], [79, 160], [163, 107], [83, 181], [200, 202], [200, 202], [200, 90], [218, 185], [212, 134], [163, 34], [163, 34]]], [[[218, 64], [155, 34], [155, 77], [177, 107], [177, 160], [91, 160], [91, 107], [91, 77], [93, 116], [108, 126], [108, 116], [53, 21], [53, 248], [7, 38], [91, 160], [64, 21], [64, 144], [206, 144], [206, 158], [125, 180], [125, 131], [101, 131], [125, 131], [64, 180], [10, 3], [10, 38], [108, 126], [143, 185], [108, 185], [163, 46], [169, 144], [124, 46], [108, 180], [64, 46], [194, 144], [10, 23], [206, 124], [64, 45], [53, 144], [53, 158], [91, 180], [79, 131], [79, 131], [218, 33], [91, 23], [91, 177], [109, 177], [109, 177], [91, 89], [79, 77], [73, 134], [73, 107], [174, 126], [125, 161], [125, 161], [174, 161], [236, 126], [91, 244], [210, 183], [171, 33], [106, 33], [218, 160], [171, 231], [171, 161], [171, 161], [81, 90], [81, 90], [81, 202], [91, 161], [108, 161], [79, 161], [64, 161], [64, 161], [64, 180], [206, 221], [206, 45], [190, 131], [124, 107], [124, 134], [130, 180], [200, 202], [200, 180], [91, 180], [64, 42], [10, 23], [109, 64], [109, 183], [91, 185], [190, 185], [190, 185], [190, 185], [155, 160], [177, 160], [190, 116], [190, 126], [190, 126], [91, 160], [91, 248], [91, 23], [163, 34], [79, 34], [91, 130], [106, 107], [106, 185], [79, 116], [206, 248], [206, 177], [169, 144], [169, 130], [200, 131], [200, 131], [200, 180], [81, 126], [108, 185], [64, 185], [125, 126], [125, 131], [174, 131], [174, 21], [174, 21], [106, 107], [73, 131], [174, 180], [108, 38], [108, 1], [155, 158], [53, 158], [177, 193], [73, 131], [73, 131], [73, 131], [81, 131], [64, 202], [81, 185], [169, 23], [109, 244], [171, 161], [79, 176], [236, 181], [81, 126], [81, 180], [64, 185], [91, 185], [236, 107], [155, 160], [108, 180], [106, 131], [153, 158], [108, 204], [108, 96], [91, 46], [91, 46], [91, 131], [64, 131], [81, 131], [81, 131], [81, 131], [81, 131], [81, 131], [81, 131], [200, 131], [200, 131], [190, 131], [108, 131], [218, 131], [218, 131], [64, 248], [163, 34], [163, 34], [163, 34], [163, 34], [163, 34], [163, 34], [163, 34], [163, 34], [163, 34], [163, 34], [163, 34], [163, 34], [163, 34], [163, 34], [163, 34], [163, 34], [163, 34], [163, 34], [163, 34], [163, 34], [163, 34], [163, 34], [163, 34], [163, 34], [163, 34], [163, 144], [163, 34], [125, 34], [130, 34], [130, 77], [206, 126], [91, 126], [174, 161], [236, 231], [106, 134], [50, 21], [106, 134], [106, 151], [106, 185], [73, 231], [79, 181], [73, 181], [73, 126], [73, 126], [91, 151], [210, 183], [109, 144], [206, 144], [206, 144], [109, 144], [169, 144], [169, 183], [218, 185], [81, 180], [81, 180], [109, 183], [210, 183], [210, 244], [93, 202], [91, 161], [91, 161], [81, 126], [81, 185], [64, 180], [125, 90], [64, 254], [169, 23], [109, 183], [109, 183], [91, 180], [81, 180], [81, 180], [200, 180], [200, 126], [190, 126], [190, 126], [190, 126], [177, 126], [177, 126], [10, 160], [241, 185], [10, 185], [207, 116], [125, 126], [91, 160], [189, 173], [174, 126], [101, 126], [108, 180], [108, 185], [53, 185], [194, 36], [53, 214], [190, 161], [190, 185], [50, 248], [106, 158], [171, 90], [171, 90], [171, 33], [171, 160], [190, 180], [190, 231], [190, 231], [79, 185], [218, 152], [218, 204], [81, 131], [64, 131], [64, 131], [125, 180], [21, 3], [11, 160], [64, 126], [155, 126], [155, 23], [53, 183], [10, 180], [174, 131], [174, 131], [108, 131], [108, 131], [190, 131], [190, 254], [190, 33], [190, 204], [212, 180], [212, 180], [91, 13], [163, 34], [163, 34], [163, 34], [163, 34]]], [[[89, 34], [79, 180], [130, 183], [130, 173], [130, 180], [64, 118], [64, 144], [23, 23], [206, 183], [206, 214], [64, 180], [64, 131], [64, 131], [64, 131], [81, 131], [81, 90], [81, 90], [81, 161], [190, 161], [171, 161], [171, 214], [171, 107], [171, 107], [171, 107], [155, 107], [177, 134], [109, 89], [109, 177], [109, 177], [109, 177], [109, 177], [91, 77], [189, 77], [189, 77], [106, 131], [190, 202], [171, 161], [155, 1], [7, 236], [109, 177], [109, 89], [190, 116], [171, 126], [79, 107], [91, 183], [130, 23], [109, 38], [200, 126], [190, 126], [190, 126], [171, 180], [218, 160], [218, 158], [53, 183], [10, 130], [91, 130], [91, 77], [91, 77], [79, 107], [171, 185], [200, 180], [81, 90], [64, 131], [212, 131], [53, 248], [23, 161], [174, 161], [207, 65], [127, 144], [169, 144], [81, 1], [101, 161], [101, 126], [125, 126], [64, 173], [23, 65], [241, 23], [206, 183], [200, 161], [108, 126], [81, 38], [64, 204], [64, 116], [64, 42], [189, 144], [163, 34], [163, 34], [64, 34], [125, 34], [64, 34], [64, 34], [64, 34], [64, 34], [64, 34], [200, 34], [125, 34], [207, 130], [177, 160], [91, 204], [91, 180], [125, 204], [91, 130], [163, 144], [109, 23], [109, 183], [109, 244], [64, 126], [125, 126], [91, 185], [218, 126], [73, 181], [91, 244], [130, 183], [91, 131], [108, 131], [73, 131], [218, 33], [218, 158], [218, 131], [73, 131], [73, 204], [206, 65], [206, 46], [64, 131], [163, 107], [83, 248], [73, 21], [73, 144], [206, 144], [206, 23], [11, 248], [210, 116], [79, 126], [79, 180], [171, 180], [171, 180], [143, 180], [108, 185], [21, 45], [210, 23], [109, 183], [91, 116], [79, 204], [177, 151], [73, 158], [64, 21], [130, 153], [64, 180], [64, 131], [108, 131], [108, 131], [108, 131], [108, 131], [200, 126], [108, 161], [108, 161], [143, 161], [190, 126], [130, 46], [130, 21], [10, 114], [241, 124], [91, 130], [163, 34], [163, 34], [163, 34], [64, 34], [64, 34], [64, 34], [64, 34], [64, 34], [64, 34], [189, 34], [91, 183], [91, 183], [130, 254], [200, 180], [23, 223], [109, 77], [109, 177], [109, 89], [190, 107], [93, 160], [79, 181], [143, 161], [174, 126], [174, 180], [106, 248], [50, 21], [228, 134], [73, 107], [73, 252], [73, 174], [73, 174], [73, 161], [79, 180], [79, 185], [109, 77], [206, 89], [109, 183], [124, 183], [124, 13], [200, 126], [200, 126], [190, 202], [171, 90], [171, 254], [171, 126], [79, 126], [79, 152], [79, 248], [155, 144], [207, 144], [163, 34], [189, 34], [207, 173], [79, 116], [79, 116], [79, 181], [79, 252], [73, 174], [73, 116], [130, 248], [130, 153], [108, 180], [174, 180], [64, 180], [155, 46], [155, 116], [108, 161], [81, 126], [108, 96], [108, 158], [162, 248], [153, 204], [81, 126], [81, 126], [81, 180], [64, 38], [64, 21], [64, 144], [64, 144], [206, 65], [206, 226], [81, 161], [81, 126], [64, 131], [101, 131], [101, 131], [64, 180], [10, 183], [109, 244], [79, 158], [155, 152], [190, 126], [200, 202], [200, 90], [200, 202], [200, 173], [91, 144], [206, 144], [206, 177], [206, 177], [206, 177], [91, 34], [163, 34], [163, 34], [73, 34], [73, 34], [163, 34], [163, 34]]], [[[89, 34], [169, 144], [130, 160], [64, 126], [125, 202], [64, 180], [64, 180], [81, 173], [207, 23], [53, 65], [10, 23], [206, 244], [190, 126], [190, 116], [206, 46], [153, 248], [124, 158], [108, 161], [108, 161], [64, 248], [212, 21], [212, 126], [64, 202], [64, 202], [64, 90], [64, 90], [64, 202], [64, 180], [81, 180], [190, 152], [190, 158], [155, 158], [53, 152], [108, 126], [108, 38], [130, 158], [130, 158], [73, 158], [215, 158], [79, 131], [64, 131], [64, 131], [125, 131], [125, 131], [91, 131], [109, 23], [206, 177], [109, 64], [241, 130], [206, 183], [109, 144], [210, 23], [210, 183], [174, 116], [174, 1], [73, 158], [155, 248], [10, 21], [206, 183], [206, 183], [64, 193], [64, 161], [81, 161], [81, 126], [81, 126], [190, 180], [190, 107], [190, 134], [190, 134], [228, 236], [53, 183], [23, 183], [109, 89], [206, 177], [206, 89], [91, 89], [189, 34], [189, 77], [189, 33], [200, 131], [200, 131], [81, 131], [81, 90], [64, 202], [174, 161], [174, 193], [64, 144], [64, 144], [64, 144], [206, 144], [206, 65], [206, 226], [79, 161], [79, 174], [215, 176], [215, 174], [81, 126], [21, 3], [10, 23], [109, 23], [109, 177], [109, 177], [109, 177], [109, 214], [81, 202], [81, 90], [64, 90], [64, 90], [33, 161], [21, 126], [228, 96], [64, 161], [73, 161], [79, 46], [220, 248], [169, 21], [109, 183], [109, 130], [91, 134], [218, 158], [108, 38], [81, 202], [81, 126], [200, 126], [200, 161], [190, 161], [171, 161], [108, 161], [108, 161], [190, 126], [190, 96], [190, 46], [190, 158], [190, 158], [79, 158], [7, 158], [53, 183], [163, 34], [163, 34], [64, 34], [64, 34], [64, 34], [64, 34], [64, 34], [64, 34], [64, 34], [64, 34], [125, 34], [207, 89], [43, 183], [206, 116], [64, 161], [64, 161], [91, 42], [91, 65], [81, 161], [81, 161], [64, 174], [64, 90], [81, 72], [81, 23], [169, 183], [190, 193], [79, 161], [73, 181], [73, 152], [91, 21], [91, 65], [91, 0], [125, 131], [64, 90], [64, 90], [64, 202], [64, 161], [64, 161], [21, 38], [174, 21], [106, 248], [108, 131], [108, 126], [143, 161], [73, 161], [73, 161], [73, 126], [73, 185], [206, 160], [109, 158], [174, 248], [106, 21], [106, 12], [143, 180], [143, 180], [143, 180], [108, 180], [64, 180], [64, 90], [64, 90], [125, 90], [125, 202], [125, 202], [64, 248], [106, 226], [64, 161], [64, 161], [108, 161], [200, 161], [190, 116], [190, 107], [190, 77], [155, 183], [155, 23], [23, 23], [206, 183], [206, 130], [190, 181], [200, 126], [81, 126], [108, 96], [155, 158], [21, 21], [210, 183], [210, 130], [91, 183], [91, 130], [91, 126], [64, 161], [125, 174], [228, 96], [228, 38], [125, 131], [125, 131], [64, 204], [23, 65], [206, 183], [206, 130], [210, 183], [210, 183], [91, 193], [64, 131], [81, 131], [228, 221], [200, 38], [81, 126], [11, 152], [210, 160], [79, 161], [79, 161], [108, 161], [108, 161], [81, 161], [64, 161], [64, 161], [64, 161], [108, 126], [190, 96], [190, 158], [190, 158], [190, 158], [79, 158], [155, 158], [163, 158], [163, 34], [163, 34], [163, 34]]], [[[89, 34], [124, 144], [124, 45], [64, 161], [108, 161], [106, 158], [106, 152], [108, 180], [81, 180], [108, 46], [206, 248], [64, 158], [174, 248], [174, 21], [21, 21], [106, 42], [101, 131], [125, 180], [125, 180], [125, 180], [7, 214], [225, 23], [206, 144], [206, 226], [174, 204], [64, 144], [169, 144], [109, 183], [109, 183], [91, 33], [125, 131], [64, 38], [155, 45], [108, 38], [108, 38], [21, 69], [10, 65], [206, 183], [206, 183], [206, 183], [91, 244], [91, 131], [81, 131], [81, 131], [81, 131], [64, 90], [64, 161], [108, 161], [228, 45], [162, 158], [43, 126], [108, 124], [64, 144], [150, 65], [210, 23], [109, 244], [143, 161], [143, 161], [143, 161], [143, 161], [79, 161], [79, 193], [220, 46], [220, 130], [91, 226], [108, 38], [79, 131], [73, 12], [106, 131], [81, 131], [81, 38], [206, 21], [206, 144], [169, 144], [109, 183], [109, 183], [91, 130], [64, 202], [64, 202], [125, 202], [125, 126], [125, 126], [64, 178], [109, 177], [109, 177], [109, 177], [109, 244], [177, 160], [177, 254], [207, 13], [207, 107], [218, 96], [200, 180], [143, 161], [73, 161], [64, 21], [91, 144], [130, 23], [130, 23], [109, 116], [64, 131], [64, 131], [64, 131], [81, 180], [155, 46], [53, 158], [67, 126], [81, 96], [130, 98], [81, 38], [81, 33], [81, 144], [169, 36], [109, 183], [109, 134], [21, 107], [21, 185], [143, 161], [143, 193], [143, 46], [177, 248], [64, 144], [206, 144], [206, 65], [206, 214], [81, 161], [108, 161], [108, 161], [108, 161], [81, 161], [81, 161], [81, 244], [109, 65], [109, 65], [206, 144], [206, 144], [206, 177], [206, 177], [206, 177], [206, 183], [91, 183], [91, 34], [163, 34], [163, 34], [64, 34], [64, 34], [64, 34], [64, 34], [64, 34], [64, 34], [163, 34], [163, 144], [163, 144], [64, 144], [125, 34], [169, 144], [200, 204], [200, 126], [190, 126], [10, 130], [109, 183], [109, 89], [109, 177], [109, 177], [109, 116], [79, 161], [215, 161], [64, 144], [81, 65], [210, 23], [109, 214], [108, 180], [23, 144], [23, 21], [174, 248], [155, 126], [125, 180], [174, 131], [174, 131], [108, 131], [207, 23], [194, 65], [169, 144], [190, 161], [79, 174], [174, 161], [64, 69], [228, 226], [64, 161], [64, 174], [125, 174], [125, 174], [125, 90], [64, 131], [108, 131], [108, 180], [21, 185], [200, 161], [190, 161], [79, 161], [79, 161], [79, 161], [21, 45], [10, 221], [81, 214], [91, 244], [189, 34], [64, 34], [64, 34], [64, 34], [163, 34], [163, 144], [163, 144], [163, 34], [108, 34], [189, 21], [169, 248], [190, 116], [171, 193], [109, 144], [210, 23], [109, 183], [109, 244], [200, 254], [190, 202], [109, 226], [109, 177], [109, 177], [109, 177], [109, 183], [79, 161], [236, 42], [50, 21], [106, 180], [64, 180], [64, 126], [108, 116], [206, 248], [206, 116], [108, 161], [108, 1], [155, 158], [241, 64], [109, 64], [109, 124], [81, 161], [64, 90], [64, 90], [64, 90], [81, 131], [64, 131], [108, 131], [155, 131], [155, 13], [10, 23], [206, 244], [190, 126], [190, 126], [171, 161], [171, 161], [171, 161], [171, 1], [10, 248], [206, 173], [91, 244], [91, 130], [163, 34], [163, 34]]]]

i=0
# quit()
tokens_seqs = [[p for p in text[0]] for text in texts]
max_len = len(max(tokens_seqs, key=len))

seqs = [
    ([[bos_symbol, bos_symbol]] if add_bos else [])
    + list(seq)
    + ([[eos_symbol, eos_symbol]] if add_eos else [])
    + [[pad_symbol, pad_symbol]] * (max_len - len(seq))
    for seq in tokens_seqs
]
tokens_batch = torch.from_numpy(
    np.array(
        [[[token_part for token_part in token] for token in seq] for seq in seqs],
        dtype=np.int64,
    )
)

tokens_lens = torch.IntTensor(
    [
        len(seq) + int(add_eos) + int(add_bos)
        for seq in tokens_seqs
    ]
)
print(tokens_batch)
print(tokens_lens)